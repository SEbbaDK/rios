pin led = input@9
int8 brightness = 0
int8 fadeAmount = 5

every 30 ms : [
  run led.write(brightness);
  brightness += fadeAmount;
]

when brightness
  | <= 0 : enter Rising
  | >= 255 : enter Falling

#priority Falling, Rising

default state Rising {
  onenter : fadeAmount = 5
}

state Falling {
  onenter : fadeAmount = -5
}